{"ast":null,"code":"import { searchAPI, sousuoAPI } from '@/api';\nexport default {\n  data() {\n    return {\n      value: \"\",\n      hotarr: [],\n      sousuoarr: [],\n      loading: false,\n      // 加载中 (状态) - 只有为false, 才能触底后自动触发onload方法\n      finished: false,\n      // 未加载全部 (如果设置为true, 底部就不会再次执行onload, 代表全部加载完成)\n      page: 1,\n      // 当前搜索结果的页码\n      timer: null // 输入框-防抖定时器\n    };\n  },\n\n  async created() {\n    const res = await searchAPI();\n    console.log(res);\n    this.hotarr = res.data.result.hots;\n  },\n  methods: {\n    async sousuofn() {\n      return await sousuoAPI({\n        keywords: this.vulue,\n        limit: 20,\n        offset: (this.page - 1) * 20\n      });\n    },\n    async btn(val) {\n      this.value = val;\n      this.finished = false;\n      const res = await this.sousuofn();\n      this.sousuoarr = res.data.result.songs;\n      this.loading = false;\n    },\n    async onLoad() {\n      // 触底事件(要加载下一页的数据咯), 内部会自动把loading改为true\n      this.page++;\n      const res = await this.getListFn();\n      if (res.data.result.songs === undefined) {\n        // 没有更多数据了\n        this.finished = true; // 全部加载完成(list不会在触发onload方法)\n        this.loading = false; // 本次加载完成\n        return;\n      }\n      this.resultList = [...this.resultList, ...res.data.result.songs];\n      this.loading = false; // 数据加载完毕-保证下一次还能触发onload\n    }\n  }\n};","map":{"version":3,"mappings":"AAkBA;AAEA;EACAA;IACA;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;;EACA;IACA;IACAC;IACA;EAEA;EACAC;IACA;MACA;QACAC;QACAC;QACAC;MACA;IACA;IACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;MACA;MACA;MACA;MACA,IACAC,qCACA;QAAA;QACA;QACA;QACA;MACA;MACA;MACA;IACA;EACA;AAEA","names":["data","value","hotarr","sousuoarr","loading","finished","page","timer","console","methods","keywords","limit","offset","res"],"sourceRoot":"src/views/Search","sources":["index.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <van-search v-model=\"value\" placeholder=\"请输入搜索关键词\" shape=\"round\" />\r\n        <div class=\"search_wrap\" v-if=\"sousuoarr.length === 0\">\r\n            <p class=\"hot_title\">热门搜索</p>\r\n            <div class=\"hot_name_wrap\">\r\n                <span class=\"hot_item\" v-for=\"(obj,index) \r\n                 in hotarr\" :key=\"index\" @click=\"btn(obj.first)\">\r\n                    {{obj.first}}</span>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- 搜索结果 -->\r\n       \r\n </div>\r\n</template>\r\n\r\n<script>\r\nimport { searchAPI, sousuoAPI } from '@/api'\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            value: \"\",\r\n            hotarr: [],\r\n            sousuoarr: [],\r\n            loading: false, // 加载中 (状态) - 只有为false, 才能触底后自动触发onload方法\r\n            finished: false, // 未加载全部 (如果设置为true, 底部就不会再次执行onload, 代表全部加载完成)\r\n            page: 1, // 当前搜索结果的页码\r\n            timer: null // 输入框-防抖定时器\r\n        };\r\n    },\r\n    async created() {\r\n        const res = await searchAPI()\r\n        console.log(res);\r\n        this.hotarr = res.data.result.hots\r\n\r\n    },\r\n    methods: {\r\n        async sousuofn() {\r\n            return await sousuoAPI({\r\n                keywords: this.vulue,\r\n                limit: 20,\r\n                offset: (this.page - 1) * 20,\r\n            });\r\n        },\r\n        async btn(val) {\r\n            this.value = val;\r\n            this.finished = false;\r\n            const res = await this.sousuofn();\r\n            this.sousuoarr = res.data.result.songs;\r\n            this.loading = false;\r\n        },\r\n        async onLoad() {\r\n            // 触底事件(要加载下一页的数据咯), 内部会自动把loading改为true\r\n            this.page++;\r\n            const res = await this.getListFn();\r\n            if (\r\n                res.data.result.songs === undefined\r\n            ) { // 没有更多数据了\r\n                this.finished = true; // 全部加载完成(list不会在触发onload方法)\r\n                this.loading = false; // 本次加载完成\r\n                return;\r\n            }\r\n            this.resultList = [...this.resultList, ...res.data.result.songs];\r\n            this.loading = false; // 数据加载完毕-保证下一次还能触发onload\r\n        },\r\n    },\r\n    \r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n.search_wrap {\r\n    padding: 0.266667rem;\r\n}\r\n\r\n/*热门搜索文字标题样式 */\r\n.hot_title {\r\n    font-size: 0.32rem;\r\n    color: #666;\r\n}\r\n\r\n/* 热搜词_容器 */\r\n.hot_name_wrap {\r\n    margin: 0.266667rem 0;\r\n}\r\n\r\n/* 热搜词_样式 */\r\n.hot_item {\r\n    display: inline-block;\r\n    height: 0.853333rem;\r\n    margin-right: 0.213333rem;\r\n    margin-bottom: 0.213333rem;\r\n    padding: 0 0.373333rem;\r\n    font-size: 0.373333rem;\r\n    line-height: 0.853333rem;\r\n    color: #333;\r\n    border-color: #d3d4da;\r\n    border-radius: 0.853333rem;\r\n    border: 1px solid #d3d4da;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}