{"ast":null,"code":"import { searchAPI, searchResultListAPI } from '@/api';\nexport default {\n  data() {\n    return {\n      value: '',\n      hotarr: [],\n      resultList: [],\n      timer: null //防抖\n    };\n  },\n\n  async created() {\n    const res = await searchAPI();\n    this.hotarr = res.data.result.hots;\n  },\n  methods: {\n    async getListFn() {\n      return await searchResultListAPI({\n        keywords: this.value,\n        limit: 20\n      }); // 把搜索结果return出去\n      // (难点):\n      // async修饰的函数 -> 默认返回一个全新Promise对象\n      // 这个Promise对象的结果就是async函数内return的值\n      // 拿到getListFn的返回值用await提取结果\n    },\n\n    async fn(val) {\n      this.value = val;\n      const res = await this.getListFn();\n      this.resultList = res.data.result.songs;\n      console.log(res);\n    },\n    async inputFn() {\n      //输入框值改变调用\n      if (this.timer) clearTimeout(this.timer);\n      this.timer = setTimeout(async () => {\n        if (this.value.length === 0) {\n          // 搜索关键词如果没有, 就把搜索结果清空阻止网络请求发送(提前return)\n          this.resultList = [];\n          return;\n        }\n        const res = await this.getListFn();\n        this.resultList = res.data.result.songs;\n      }, 900);\n    }\n  }\n};","map":{"version":3,"mappings":"AAyBA;AAEA;EACAA;IACA;MACAC;MACAC;MACAC;MACAC;IAEA;EACA;;EACA;IACA;IACA;EACA;EACAC;IAEA;MACA;QACAC;QACAC;MACA;MACA;MACA;MACA;MACA;IACA;;IACA;MACA;MAEA;MAEA;MACAC;IACA;IACA;MAAA;MACA;MACA;QACA;UACA;UACA;UACA;QACA;QACA;QACA;MACA;IACA;EACA;AACA","names":["data","value","hotarr","resultList","timer","methods","keywords","limit","console"],"sourceRoot":"src/views/Search","sources":["index.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <van-search v-model=\"value\" placeholder=\"请输入搜索关键词\" shape=\"round\" @input=\"inputFn\" />\r\n        <div class=\"search_wrap\" v-if=\"resultList.length===0\">\r\n            <p class=\"hot_title\">热门搜索</p>\r\n            <div class=\"hot_name_wrap\">\r\n                <span class=\"hot_item\" v-for=\"(obj,index) \r\n                 in hotarr\" :key=\"index\" @click=\"fn(obj.first)\">\r\n                    {{obj.first}}</span>\r\n            </div>\r\n        </div>\r\n    <div class=\"search_wrap\" v-else>\r\n        <p class=\"hot_title\">最佳匹配</p>\r\n        <van-cell :title=\"obj.name\" :label=\"obj.ar[0].name\" center v-for=\"obj in resultList\" :key=\"obj.id\" >\r\n            <template #right-icon>\r\n                <van-icon name=\"play-circle-o\" size=\"0.6rem\" />\r\n               \r\n            </template>\r\n        </van-cell>\r\n       \r\n    </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { searchAPI, searchResultListAPI } from '@/api'\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            value: '',\r\n            hotarr: [],\r\n            resultList: [],\r\n            timer:null//防抖\r\n            \r\n        }\r\n    },\r\n    async created() {\r\n        const res = await searchAPI()\r\n        this.hotarr = res.data.result.hots\r\n    },\r\n    methods: {\r\n     \r\n        async getListFn() {\r\n            return await searchResultListAPI({\r\n                keywords: this.value,\r\n                limit: 20,\r\n            }); // 把搜索结果return出去\r\n            // (难点):\r\n            // async修饰的函数 -> 默认返回一个全新Promise对象\r\n            // 这个Promise对象的结果就是async函数内return的值\r\n            // 拿到getListFn的返回值用await提取结果\r\n        },\r\n        async fn(val) {\r\n            this.value = val;\r\n\r\n            const res = await this.getListFn()\r\n\r\n            this.resultList = res.data.result.songs;\r\n            console.log(res);\r\n        },\r\n        async inputFn(){//输入框值改变调用\r\n            if (this.timer) clearTimeout(this.timer)\r\n            this.timer = setTimeout(async () => {\r\n            if (this.value.length === 0) {\r\n                // 搜索关键词如果没有, 就把搜索结果清空阻止网络请求发送(提前return)\r\n                this.resultList = [];\r\n                return;\r\n            }\r\n            const res = await this.getListFn()\r\n                this.resultList = res.data.result.songs;\r\n            }, 900)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.search_wrap {\r\n    padding: 0.266667rem;\r\n}\r\n\r\n/*热门搜索文字标题样式 */\r\n.hot_title {\r\n    font-size: 0.32rem;\r\n    color: #666;\r\n}\r\n\r\n/* 热搜词_容器 */\r\n.hot_name_wrap {\r\n    margin: 0.266667rem 0;\r\n}\r\n\r\n/* 热搜词_样式 */\r\n.hot_item {\r\n    display: inline-block;\r\n    height: 0.853333rem;\r\n    margin-right: 0.213333rem;\r\n    margin-bottom: 0.213333rem;\r\n    padding: 0 0.373333rem;\r\n    font-size: 0.373333rem;\r\n    line-height: 0.853333rem;\r\n    color: #333;\r\n    border-color: #d3d4da;\r\n    border-radius: 0.853333rem;\r\n    border: 1px solid #d3d4da;\r\n}\r\n.van-cell {\r\n    border-bottom: 1px solid gray;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}